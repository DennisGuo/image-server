!function(e){if(!e.Tangular){var n={};n.helpers={},n.version='v2.0.0',n.cache={},n.ENCODE=/[<>&"]/g,n.TRIM=/\n$/g,n.debug=!1,n.settings={delimiters:['{{','}}']},n.i={},n.i.white=/\W/,n.i.numbers={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1},n.i.allow={$:1,'.':1},e.Ta=e.Tangular=n,n.register=function(e,r){return n.helpers[e]=r,n},n.compile=function(e){e||(e='');for(var r,t=-1,i=[],s=-1,u=0,l=e.length,a=0,o=n.settings.delimiters[0].length,c=[],f=-1;l>t++;){var g=e.substring(t,t+o);if(-1===s)if(g!==n.settings.delimiters[0]);else{if(-1!==s){a++;continue}(r=e.substring(u,t))&&-1===(f=c.indexOf(r))&&(f=c.length,c.push(r)),i.push(r?'txt['+f+']':'""'),s=t+o}else if(g===n.settings.delimiters[1]){if(a>0){a--;continue}var h=(w=e.substring(s,t).trim()).substring(0,3);if('if '===h||'for'===h||'end'===w||'fi'===w||'else'===w||'else if'===w){var p=c.length-1;c[p]&&(c[p]=c[p].replace(n.TRIM,''))}i.push(w),u=t+o,s=-1;continue}}(r=e.substring(u,l))&&-1===(f=c.indexOf(r))&&(f=c.length,c.push(r)),i.push(r?'txt['+f+']':'""'),l=i.length;for(var d='var $s=this,$output="",$t,$v;',$=[],v=!1,b=0,m=0;m<l;m++)if(m%2!=0){var w=i[m],x=!1,t=w.lastIndexOf('|'),T=null,O=w.substring(0,3);'if '===O&&(w='if( '+w.substring(3)+'){',x=!0),'foreach '===w.substring(0,8)&&('var'===(T=w.split(' '))[1]&&T.splice(1,1),$.push(T[1]),x=!0,v=!0,b++);var y=w.substring(0,5);if('endif'===y||'fi'===w?(w='}',x=!0):'else'===y?(w='}else{',x=!0):'else if'===w.substring(0,7)?(w='}else if( '+w.substring(8)+'){',x=!0):'end'!==O&&'endfor'!==w.substring(0,6)||(w=$.length?'}})()}':'}}',$.pop(),x=!0,--b||(v=!1)),w=x?n.append(w,$,v,'$s').trim():n.helper(w,$,v,'$s'),x){if(T){var j=n.append(T[3],$,v,'$s');w='if ('+j+'&&'+j+'.length){(function(){for(var i=0,length='+j+'.length;i<length;i++){var '+T[1]+'='+j+'[i];var $index=i;'}d+=w}else d+='$output+='+w+';'}else d+='$output+='+i[m]+';';var C=59===d.charCodeAt(d.length-1);return n.debug&&(console.log('Tangular:'),console.log('function(helpers,$){'+d+(C?'':';')+'return $output;'),console.log(e.trim()),console.log('---------------------------'),console.log('')),function(e,r){return new Function('helpers','$','txt',d+(C?'':';')+'return $output;').call(e,n.helperhandling,r,c)}},n.helperhandling=function(e){var r=n.helpers[e];return r||(console.warn('Tangular helper "'+e+'" not found.'),function(e){return void 0===e?'undefined':null===e?'null':e.toString()})},n.helper=function(e,r,t){var i,s=e.indexOf('|');if(-1===s)return'helpers("encode").call($s,'+(i=n.append(e.trim(),r,t,'$s').trim())+')';i=n.append(e.substring(0,s).trim(),r,t).trim();for(var u='',l=0,a=(e=e.substring(s+1).trim().split('|')).length;l<a;l++){var o,c=e[l].trim().replace('()','');-1===(s=c.indexOf('('))?(o=c,c='.call($s,$t)'):(o=c.substring(0,s),c='.call($s,$t,'+c.substring(s+1)),u+=(c='$t=helpers("'+o+'")'+c)+';'}return'"";$t='+i+';'+u+'$output+=$t'},n.parse=function(e,r){for(var t=[],i=null,s=[],u=0,l=e.length;u<l;u++){var a=e.substring(u,u+1);a!==i?i?s.push(a):'\''!==a&&'"'!==a?!n.i.numbers[a]||t.length?n.i.allow[a]||!n.i.white.test(a)?' '!==a?t.push(a):s.push(a):(t.length&&(s.push(r(t.join(''))),t=[]),s.push(a)):s.push(a):(t.length&&(s.push(r(t.join(''))),t=[]),i=a,s.push(a)):(i=null,t=[],s.push(a))}return t.length&&s.push(r(t.join(''))),s.join('')},n.append=function(e,r,t,i){return void 0===r&&(r=[]),e?n.parse(e,function(e){switch(e.trim()){case'else':case'end':case'endfor':case'endif':case'fi':case'foreach':case'if':case'true':case'false':case'else if':case'$index':return e}for(var n=!1,t=0,s=r.length;t<s;t++){var u=r[t].length;if(e.substring(0,u)===r[t]){if(e.length!==u){var l=e.substring(u,u+1);if('.'!==l&&'+'!==l)continue}n=!0;break}}if('$'===e)return'Tangular.$wrap($)';if('$.'===e.substring(0,2)&&(i='$',e=e.substring(2)),n)return e;var a=(l=e.substring(0,1)).charCodeAt(0);return a>47&&a<58?e:'Tangular.$wrap('+(i||'$s')+',"'+e+'")'}):'Tangular.$wrap('+(i||'$s')+')'},n.$wrap=function(e,r){if(!e||!r)return e;var t=n.cache[r];if(null===t)return e[r];if(t)return t(e);if(1===r.split('.').length)return n.cache[r]=null,e[r];try{t=n.cache[r]=new Function('XYZ','try{return XYZ.'+r+'}catch(e){return ""}')}catch(e){t=new Function('return ""')}return t(e)},n.render=function(e,r,t){return null==r&&(r={}),'string'==typeof e&&(e=n.compile(e)),e(r,t)},n.register('encode',function(e){return null==e?'':e.toString().replace(n.ENCODE,function(e){switch(e){case'&':return'&amp;';case'<':return'&lt;';case'>':return'&gt;';case'"':return'&quot;'}return e})}),n.register('raw',function(e){return null==e?'':e})}}(window);
